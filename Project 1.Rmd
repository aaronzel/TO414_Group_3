---
title: "Project 1"
author: "Aaron Zelmanov, Muhammad Hafizudeen Mohamad Saman, Nakul Chadha, Kendall Cohen, Michael Geraci, Michael Zhang"
date: "2/12/2021"
output:
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Read Data
```{r}
hotel <- read.csv("hotel_bookings.csv")
#str(hotel)
#head(hotel)
```

## Data Cleaning
```{r}
hotel$hotel <- as.factor(hotel$hotel)
hotel$is_canceled <- as.logical(hotel$is_canceled)
hotel$arrival_date_year <-as.factor(hotel$arrival_date_year)
hotel$arrival_date_month <-as.factor(hotel$arrival_date_month)
hotel$meal <-as.factor(hotel$meal)
hotel$market_segment <-as.factor(hotel$market_segment)
hotel$country <-as.factor(hotel$country)
hotel$distribution_channel <-as.factor(hotel$distribution_channel)
hotel$is_repeated_guest <-as.logical(hotel$is_repeated_guest)
hotel$customer_type <-as.factor(hotel$customer_type ) 
hotel$reservation_status <-as.factor(hotel$reservation_status)
hotel$reserved_room_type <- as.factor(hotel$reserved_room_type)
hotel$assigned_room_type <- as.factor(hotel$assigned_room_type)
hotel$deposit_type <- as.factor(hotel$deposit_type)
```

## Data Exploration


**Average number of people that stays at each hotel**
```{r}
hotel$num_people <- hotel$adults + hotel$children + hotel$babies
aggregate(num_people~hotel, data = hotel, mean)
```
The table above shows the mean number of guests per reservation 
<br />
<br />
**Hotel cancellations**
```{r}
tableCancellations <- table(hotel$is_canceled)
tableCancellations
```
*Table above shows the number of hotels cancelled and not cancelled. Total bookings = 119,390*
<br />
<br />
**Cancellations by hotel type**
```{r}
tableCancellationsbyType <- aggregate(is_canceled ~ hotel, data = hotel, sum)
cityHotels <- sum(hotel$hotel == "City Hotel", na.rm = TRUE)
resortHotels <- sum(hotel$hotel == "Resort Hotel", na.rm = TRUE)
tableCancellationsbyType$prop_cancelled <- c(round(33102/cityHotels, 2), round(11122/resortHotels, 2))
tableCancellationsbyType
```
*Table above shows the number of cancellations per hotel type and the proportion of each hotel's bookings that are cancelled* 
<br />
<br />
**Cancellations by market segment**
```{r}
tableCancellationsbyMarket <- aggregate(is_canceled ~ market_segment, data = hotel, length)
tableCancellationsbyMarket
```
*Table above shows the cancellations per market segment* 

#-----------

In this section, we will explore the data. First, lets see how much of the people canceled their bookings.

```{r}
# Canceled bookings
plot(as.factor(hotel$is_canceled), xlab= "is_cancelled", ylab = "number of people")
nrow(hotel[hotel$is_canceled == 1,])/nrow(hotel)
```

We can see that more than a third canceled their bookings.

How about the arrival month? Is there any famous months for hotel reservation?
```{r}
plot(hotel$arrival_date_month, las = 2)
table(hotel$arrival_date_month)
```
The most famous moth for hotel arrival date is August. In the trend, we can see that the months with the lowest number of arrival months are months at the end and the beginning of the year, particularly from November-February


Does any of the months has abnormally high rate of cancellation?
```{r}
#rate of cancellation by month
cancellationsbymonth <- tapply(hotel$is_canceled, hotel$arrival_date_month, mean, na.rm = TRUE)
cancellationsbymonth
barplot(sort(cancellationsbymonth), las = 2)
```
Most of the months has about 30-40% rate of cancellation, so wa cannot definitely say for sure that month affect the rate of cancellation.


```{r}
test_var <- c(234)
```